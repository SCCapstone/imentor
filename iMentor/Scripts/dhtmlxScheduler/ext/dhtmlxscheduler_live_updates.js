/*
@license
dhtmlxScheduler.Net v.3.3.12 

This software is covered by DHTMLX Evaluation License. Contact sales@dhtmlx.com to get Commercial or Enterprise license. Usage without proper license is prohibited.

(c) Dinamenta, UAB.
*/
Scheduler.plugin(function(e){if("undefined"!=typeof dataProcessor){var t=dataProcessor.prototype.init;dataProcessor.prototype.init=function(){t.apply(this,arguments);var e=this;this.attachEvent("onAfterUpdate",function(t,i,a,n){var r;r=e.obj.exists(a)?e.obj.item(a):e.obj.exists(t)?e.obj.item(t):{},"undefined"!=typeof r.$selected&&delete r.$selected,"undefined"!=typeof r.$template&&delete r.$template,e.callEvent("onLocalUpdate",[{sid:t,tid:a,status:i,data:r}])})},dataProcessor.prototype.applyChanges=function(e){
var t=this,i=e.sid,a=e.tid,n=e.status,r=e.data;switch(t.obj.isSelected(i)&&(r.$selected=!0),n){case"updated":case"update":case"inserted":case"insert":t.obj.exists(i)?(t.obj.isLUEdit(r)===i&&t.obj.stopEditBefore(),t.ignore(function(){t.obj.update(i,r),i!==a&&t.obj.changeId(i,a)})):(r.id=a,t.ignore(function(){t.obj.add(r)}));break;case"deleted":case"delete":t.ignore(function(){var e=t.obj.exists(i);e&&(t.obj.setUserData(i,"!nativeeditor_status","true_deleted"),t.obj.stopEditBefore()),t.obj.remove(i,r),
e&&t.obj.isLUEdit(r)===i&&(t.obj.preventLUCollision(r),t.obj.callEvent("onLiveUpdateCollision",[i,a,n,r])===!1&&t.obj.stopEditAfter())})}}}"undefined"!=typeof e&&(e.item=function(t){var i=this.getEvent(t);if(!i)return{};var a={};for(var n in i)a[n]=i[n];return a.start_date=e.date.date_to_str(e.config.api_date)(i.start_date),a.end_date=e.date.date_to_str(e.config.api_date)(i.end_date),a},e.update=function(t,i){var a=this.getEvent(t);for(var n in i)"start_date"!=n&&"end_date"!=n&&(a[n]=i[n]);var r=e.date.str_to_date(e.config.api_date);

e.setEventStartDate(t,r(i.start_date)),e.setEventEndDate(t,r(i.end_date)),this.updateEvent(t),this.callEvent("onEventChanged",[t])},e.remove=function(t,i){if(this.exists(t)){var a=this.getEvent(t);if(this._get_rec_markers){a.rec_type&&this._roll_back_dates(a);var n=this._get_rec_markers(t);for(var r in n)n.hasOwnProperty(r)&&(t=n[r].id,this.getEvent(t)&&this.deleteEvent(t,!0))}this.deleteEvent(t,!0)}else i&&i.event_pid&&e.add(i)},e.exists=function(e){var t=this.getEvent(e);return t?!0:!1},e.add=function(e){
var t=this.addEvent(e.start_date,e.end_date,e.text,e.id,e);return this._is_modified_occurence&&this._is_modified_occurence(e)&&this.setCurrentView(),t},e.changeId=function(e,t){return this.changeEventId(e,t)},e.stopEditBefore=function(){},e.stopEditAfter=function(){this.endLightbox(!1,this._lightbox)},e.preventLUCollision=function(e){this._new_event=this._lightbox_id,e.id=this._lightbox_id,this._events[this._lightbox_id]=e},e.isLUEdit=function(e){return this._lightbox_id?this._lightbox_id:null},e.isSelected=function(e){
return!1})});